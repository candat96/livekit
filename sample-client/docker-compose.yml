version: '3.8'

services:
  redis:
    image: redis:7-alpine
    restart: unless-stopped
    volumes:
      - redis_data:/data

  livekit:
    image: livekit/livekit-server:latest
    restart: unless-stopped
    command: --config /etc/livekit.yaml
    ports:
      - "7880:7880"
      - "7881:7881"
      - "50000-50020:50000-50020/udp"
    volumes:
      - ./livekit.yaml:/etc/livekit.yaml:ro
    depends_on:
      - redis

  sample-client:
    build: .
    restart: unless-stopped
    ports:
      - "3001:3001"
    environment:
      - PORT=3001
      - LIVEKIT_API_KEY=apikey
      - LIVEKIT_API_SECRET=Abc@123
      - LIVEKIT_URL=ws://194.233.66.68:7880
    depends_on:
      - livekit

volumes:
  redis_data:
